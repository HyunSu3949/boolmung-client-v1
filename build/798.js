"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[798],{798:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var n=r(9250),l=r(5007),o=r(7294),s=r(4913),a=r(2217),u=r(8147),i=r(4440),c=r(5893);function d(){var e=(0,o.useRef)(null),t=(0,o.useRef)(null),r=(0,l.v9)((function(e){return e.reducer.socketReducer.messageList})),n=(0,l.v9)((function(e){return e.reducer.authReducer})).user;return(0,o.useEffect)((function(){var r,n,l,o,s=null===(r=e.current)||void 0===r?void 0:r.scrollHeight,a=null===(n=t.current)||void 0===n?void 0:n.clientHeight;s&&a&&s>a&&(null===(l=e.current)||void 0===l||null===(o=l.lastElementChild)||void 0===o||o.scrollIntoView({behavior:"smooth"}))}),[r]),(0,c.jsx)("div",{ref:t,className:"w-full p-4 bg-gray-800 rounded-lg ",children:(0,c.jsx)("ul",{ref:e,className:"space-y-2",children:r.map((function(e,t){return(0,c.jsxs)("li",{className:"rounded-lg p-2 ".concat("user"===e.type?"".concat(n._id===e._id?"bg-blue-500":" bg-slate-400"," text-white"):"bg-slate-700 text-center text-gray-300"),children:[(0,c.jsx)("span",{className:"font-bold",children:e.name}),(0,c.jsx)("p",{children:e.message})]},t)}))})})}var f=r(3177);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x(e){var t,r,n=e.userId,s=e.userName,a=e.roomId,i=(t=(0,o.useState)(""),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,l,o,s,a=[],u=!0,i=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){i=!0,l=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(i)throw l}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=i[0],x=i[1],g=(0,l.I0)(),h=(0,o.useRef)(null);return(0,c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),""!==d.trim()&&(function(e){g((0,f.bG)({message:e,_id:n,name:s,roomId:a}))}(d.trim()),x(""))},className:"flex space-x-2 py-2",children:[(0,c.jsx)("input",{ref:h,onChange:function(e){x(e.target.value)},type:"text",value:d,className:"flex-1 rounded-lg border border-gray-700 bg-gray-800 p-2 text-white focus:border-blue-500 focus:outline-none",placeholder:"메시지 입력..."}),(0,c.jsx)("button",{className:"rounded-lg bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700",type:"submit",children:(0,c.jsx)(u.Z,{id:"up-arrow",size:"1.25rem",title:"전송버튼"})})]})}function g(){var e=(0,o.useRef)(null),t=(0,l.v9)((function(e){return e.reducer.authReducer})).user,r=(0,n.UO)().roomid;return(0,c.jsxs)("div",{ref:e,className:"flex w-full flex-1 flex-col bg-gray-900 p-2 text-white",children:[(0,c.jsx)("div",{className:"flex w-full flex-1 overflow-auto rounded-lg border border-gray-700 bg-gray-800",children:(0,c.jsx)(d,{})}),(0,c.jsx)(x,{userId:t._id,userName:t.name,roomId:r})]})}function h(){var e=(0,l.I0)(),t=(0,n.s0)(),r=(0,n.UO)().roomid,d=(0,l.v9)((function(e){return e.reducer.authReducer})).user,m=(0,l.v9)((function(e){return e.reducer.socketReducer.roomInfo})).title,x=(0,l.v9)((function(e){return e.reducer.socketReducer.errorMassage})),h=function(){t("/")},b=function(){e((0,s.sT)({errorState:!1,message:""})),h()};return(0,o.useEffect)((function(){e((0,f.$j)({_id:d._id,roomId:r,name:d.name,image:d.image}));var t=function(){localStorage.setItem("isReloading","true")};return window.addEventListener("beforeunload",t),"true"===localStorage.getItem("isReloading")&&localStorage.removeItem("isReloading"),function(){window.removeEventListener("beforeunload",t),e((0,f.Zu)({_id:d._id})),"true"!==localStorage.getItem("isReloading")&&e((0,s.zP)())}}),[e,r,d]),(0,c.jsxs)("main",{className:"static flex flex-col flex-1 w-full bg-slate-900",children:[(0,c.jsxs)("div",{className:"flex min-h-[10vh] items-center space-x-4 p-4",children:[(0,c.jsx)("div",{className:"absolute p-4 rounded-md left-3 bg-slate-600",children:(0,c.jsx)(i.c,{})}),(0,c.jsxs)("button",{onClick:h,className:"flex items-center px-4 py-2 text-white rounded bg-slate-600 hover:bg-slate-400 focus:outline-none",type:"button",children:[(0,c.jsx)(u.Z,{id:"exit",size:"1.25rem",title:"나가기 아이콘"}),"나가기"]}),(0,c.jsx)("p",{className:"text-xl text-white",children:m})]}),(0,c.jsx)("div",{className:"flex max-h-[90vh] w-full flex-1",children:(0,c.jsx)(g,{})}),x&&(0,c.jsx)(a.u,{isOpen:!0,closeModal:b,children:(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center p-8",children:[(0,c.jsx)("p",{className:"mb-4 text-slate-200",children:x}),(0,c.jsx)("button",{onClick:b,type:"button",className:"p-2 rounded-md bg-slate-500 text-slate-200",children:"나가기"})]})})]})}}}]);